#!/bin/bash
# Alexs .bashrc
# loaded by bash when any non-login shell started

#
# Source global definitions
#

if [ -f /etc/bashrc ]; then
    source /etc/bashrc
fi

if [ -f /etc/bash.bashrc ]; then
    source /etc/bash.bashrc
fi

#############
# Aliases
#############

# I like a quick grep of history
alias h="history | grep"


#
# Some systems I use don't have a decent 'find' implentation so
#
FIND=`find --version 2>/dev/null`
if [  "${FIND:0:8}" == "GNU find" ]; then

    # Some nice find expressions
    FIND_BACKUPS=" -name '.#*' -o -name '#*#' -o -name '*\.~*.~' -o -path '*./CVS/*.'"
    FIND_CVS=" -path '*./CVS/.*' "
    FIND_CCODE="  -iname '*.[chS]' -or -iname '*.cc' "
    FIND_CHEAD=" -iname '*.h' "
        
    # Find files under here
    alias f='find . -iname'

    # and search code for stuff (when I figure out proper expansion and quuting I'll make this neater)
    
    #alias sc="find . -iname '*.[chS]' -or -iname '*.cc' -and -not \( -name '.#' -o -name '#*#' -o -name '*\.~*.~' -o -path '*./CVS/*.' \) -print0 | xargs -0 grep -H "

    alias sc="find . \( $FIND_CCODE \) -and -not \( $FIND_BACKUPS -o $FIND_CVS \) -print0 | xargs -0 grep -H"
    alias sh="find . -iname '*.h' -print0 | xargs -0 grep -H "
    alias sa="find . -xtype f -print0 | xargs -0 grep -H "
else
    #
    # Who knows how standard unix is, its not GNU so probably not
    #
    # Lets assume both find and grep are borken
    #

    # Find files under here
    alias f="find . -name"

    # and search code for stuff
    alias sc="find . -name '*.[chS]' -o  -name '*.cc' | xargs grep "
    alias sh="find . -name '*.h' | xargs grep "
    alias sa="find -L . -type f | xargs grep "
fi    

# create patches easily
export DIFFIGNORE="-x*~ -x*.o -x*.pyc "
alias mkpatch="diff -Naur $DIFFIGNORE "

######################
# Environent Variables
######################

# There is only one editor
export EDITOR=emacs

# set CFLAGS for debugging - autoconf usually picks it up.
export CFLAGS=-g3

# CVS exports
export CVS_RSH=ssh
export CVSEDITOR=emacs

# Setup history control - hard to get right, could do with
# bashcompletion as well. Just make sure I don't repeatedly delete stuff

export HISTCONTROL=ignoredups
export HISTIGNORE="rm*"
export HISTFILESIZE=2000

# Setup the prompt to show who I am and on what machine
export PS1="\A \u@\h [\W] >"


# GNU systems usually use less by default for
# man pages, however not all unix-a-likes do
export PAGER=less

########################
# Miscelaneous Stuff
########################
# I want core-dumps dammit
ulimit -S -c unlimited

#
# Now source any local bashrc's which can overide stuff
# or add stuff relevant to the system I am on
#
if [ -f $HOME/.bashrc_local ]; then
    source $HOME/.bashrc_local
fi
